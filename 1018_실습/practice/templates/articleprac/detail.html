{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}
{% block content %}
  <div class="d-flex justify-content-center">
    <div class="card_css text-center" style="width:40rem; height:auto; margin-top:10%; margin-bottom: 5%;">
      <div class="my-3">
        {{ form.title }}
      </div>
      <div class="card-body">
        <div style="height:45vh;">
          {% if form.image %}
            <!--이미지가 있을 경우 resize된 이미지 반환-->
            <img src="{{ form.image.url }}" alt="..." style="width: 100%; height:100%; opacity: 80%;">
          {% else %}
            <!--없는 경우 static 파일의 이미지 가져오기-->
            <img src="{% static 'images/unnamed.jpg' %}" alt="..." style="width: 100%; height:100%; opacity: 80%;">
          {% endif %}
        </div>
        <h5 class="my-3">{{ form.title }}</h5>
        <p class="card-text">{{ form.content }}</p>
        {% if request.user == comment.user %}
        <div class="d-flex justify-content-between mb-3">
          <a class="btn btn-success ms-5" href="{% url 'prac:edit' form.pk %}">수정</a>
          <a class="btn btn-danger me-5" href="{% url 'prac:delete' form.pk %}">삭제</a>
        </div>
        {% endif %}
        <hr style="margin:3px 0px 0px 0px; color:white">
        <div class="py-3" style="line-height: 10px; color:white;">
          생성 시간 :
          {{ form.created_at }}
          <hr>
          수정 시간 :
          {{ form.updated_at }}
        </div>
      </div>
    </div>
  </div>

  <div class="container d-flex flex-column" style="align-items:center;">
    <div class="d-flex justify-content-center mb-5 w-75">
      <div class='w-75'>
      <form action="{% url 'prac:comment_create' form.pk %}" method='POST'>
        {% csrf_token %}
        <h5 class="text-center" style="color: white; margin-bottom: 15px">방명록</h5>
      <div class="d-flex w-100">
        <div style="color:white; width:90%">
          {{ comment_form }}
        </div>
        <div style="display:flex; align-items:flex-end;" style="width:10%">
          <button class="btn btn-light h-100" type="submit">작성</button>
        </div>
      </div>
        {% comment %} <textarea name="content" cols="100" rows="2" placeholder="댓글을 입력하세요"></textarea> {% endcomment %}
      </form>
    </div>
    </div>
    <div class="row d-flex justify-content-around w-100">
      {% for comment in comments %}
        <div class="paper col-12 col-lg-3 ms-3 d-flex flex-column" style="height:20vh;">
          <p class="mt-3">{{ comment.user }}</p>
          <hr>
          <p class="text_detail" style="overflow:hidden; white-space:nowrap; width:100%; height:100%;text-overflow: ellipsis;">{{ comment.content }}</p>
          {% if request.user == comment.user %}
          <div class="d-flex justify-content-between mb-3" style="align-items:flex-end;">
            <a class="btn btn-success ms-3" href="{% url 'prac:edit' form.pk %}">수정</a>
            <form action="{% url 'prac:comment_delete' form.pk comment.pk %}" method="POST">
              {% csrf_token %}
              <input class="btn btn-danger me-3" type="submit" value="삭제">
          </form>
          </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
{% endblock content %}